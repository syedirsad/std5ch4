<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ркнрк╛ркЧ ркЕркирлЗ рккрлВрк░рлНркг - ркЕрккрлВрк░рлНркгрк╛ркВркХ рк╢рлАркЦрлЛ</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f9ff; /* Light blue background */
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top to allow scrolling */
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .game-container {
            background-color: #ffffff;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 100%;
            max-width: 900px;
            text-align: center;
            border: 2px solid #a7d9f7; /* Light blue border */
            overflow: hidden; /* Ensure content stays within bounds */
        }
        .button {
            background-color: #3b82f6; /* Blue */
            color: white;
            padding: 12px 25px;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .button:hover {
            background-color: #2563eb; /* Darker blue */
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        .button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .fraction-display {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e40af; /* Dark blue */
            margin-top: 20px;
            margin-bottom: 30px;
        }
        .pizza-slice {
            fill: #fcd34d; /* Yellow for pizza base */
            stroke: #fbbf24; /* Darker yellow border */
            stroke-width: 2;
            transition: fill 0.3s ease;
        }
        .pizza-slice.selected {
            fill: #ef4444; /* Red for selected slices */
        }
        .flag-stripe {
            transition: background-color 0.3s ease;
        }
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            text-align: center;
            min-width: 300px;
            max-width: 90%;
            border: 3px solid #3b82f6;
        }
        .message-box h3 {
            font-size: 1.8rem;
            color: #1e40af;
            margin-bottom: 20px;
        }
        .message-box p {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 25px;
        }
        .message-box button {
            background-color: #3b82f6;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .message-box button:hover {
            background-color: #2563eb;
        }

        /* Styling for the triangle activity */
        .triangle-container {
            position: relative;
            width: 250px;
            height: 216.5px; /* Height for equilateral triangle based on width */
            margin: 30px auto;
            border: 2px solid #3b82f6;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .triangle-svg {
            width: 100%;
            height: 100%;
        }
        .triangle-part {
            fill: #f0f9ff; /* Light background for parts */
            stroke: #a7d9f7;
            stroke-width: 1;
            transition: fill 0.3s ease;
            cursor: pointer;
        }
        .triangle-part.colored {
            fill: #ef4444; /* Red for colored parts */
        }

        /* Styling for the rectangle activity */
        .rectangle-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* Example for 6 parts (2 rows, 3 cols) */
            grid-template-rows: repeat(2, 1fr);
            width: 300px;
            height: 200px;
            margin: 30px auto;
            border: 2px solid #3b82f6;
            border-radius: 10px;
            overflow: hidden;
        }
        .grid-cell {
            background-color: #f0f9ff;
            border: 1px solid #a7d9f7;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .grid-cell.colored {
            background-color: #ef4444;
        }

        /* Styling for the spinning top (bhambardo) */
        .spinning-top-container {
            width: 200px;
            height: 200px;
            margin: 30px auto;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .spinning-top-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            border: 2px solid #3b82f6;
        }
        .spinning-top-segment {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-origin: 50% 50%;
            clip-path: polygon(50% 50%, 100% 0%, 100% 50%); /* Example for a segment */
            /* This will be dynamically generated via JS for correct angles */
        }
        .spinning-button {
            background-color: #10b981; /* Green */
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        .spinning-button:hover {
            background-color: #059669;
            transform: translateY(-2px);
        }

        /* Styling for the vegetable farm */
        .farm-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4x4 grid for simplicity */
            grid-template-rows: repeat(4, 1fr);
            width: 350px;
            height: 350px;
            margin: 30px auto;
            border: 2px solid #3b82f6;
            border-radius: 10px;
            overflow: hidden;
        }
        .farm-cell {
            border: 1px solid #a7d9f7;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 0.9rem;
            color: #333;
            background-color: #dcfce7; /* Light green for farm */
        }
        .farm-cell img {
            width: 40px;
            height: 40px;
            margin-bottom: 5px;
        }
        .farm-cell span {
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div id="gameContainer" class="game-container">
        <h1 class="text-4xl font-bold text-blue-700 mb-8">ркнрк╛ркЧ ркЕркирлЗ рккрлВрк░рлНркг: ркЕрккрлВрк░рлНркгрк╛ркВркХ рк╢рлАркЦрлЛ!</h1>

        <!-- Main Menu -->
        <div id="mainMenu" class="space-y-4">
            <h2 class="text-2xl font-semibold text-gray-700 mb-6">ркЪрк╛рк▓рлЛ ркЕрккрлВрк░рлНркгрк╛ркВркХ рк╢рлАркЦрлАркП!</h2>
            <button class="button w-full" onclick="showActivity('introFractions')">1. ркЕрккрлВрк░рлНркгрк╛ркВркХркирлЛ рккрк░рк┐ркЪркп</button>
            <button class="button w-full" onclick="showActivity('flagFractions')">2. рк░рк╛рк╖рлНркЯрлНрк░рлАркп ркзрлНрк╡ркЬркорк╛ркВ ркЕрккрлВрк░рлНркгрк╛ркВркХ</button>
            <button class="button w-full" onclick="showActivity('circleParts')">3. рк╡рк░рлНркдрлБрк│ркирк╛ ркнрк╛ркЧрлЛ</button>
            <button class="button w-full" onclick="showActivity('chocolateHats')">4. ркЪрлЛркХрк▓рлЗркЯ ркЕркирлЗ ркЯрлЛрккрлАркУркорк╛ркВ ркЕрккрлВрк░рлНркгрк╛ркВркХ</button>
            <button class="button w-full" onclick="showActivity('geometricShapes')">5. ркнрлМркорк┐ркдрк┐ркХ ркЖркХрк╛рк░рлЛркирк╛ ркнрк╛ркЧрлЛ</button>
            <button class="button w-full" onclick="showActivity('greedyGatekeeper')">6. рк▓рлЛркнрлА ркЪрлЛркХрлАркжрк╛рк░ркирлА рк╡рк╛рк░рлНркдрк╛</button>
            <button class="button w-full" onclick="showActivity('patternsFractions')">7. рккрлЗркЯрк░рлНрки ркЕркирлЗ ркЕрккрлВрк░рлНркгрк╛ркВркХ</button>
            <button class="button w-full" onclick="showActivity('vegetableFarm')">8. рк╢рк╛ркХркнрк╛ркЬрлАркирлБркВ ркЦрлЗркдрк░</button>
        </div>

        <!-- Activity Containers -->

        <!-- 1. ркЕрккрлВрк░рлНркгрк╛ркВркХркирлЛ рккрк░рк┐ркЪркп (Introduction to Fractions) -->
        <div id="introFractions" class="hidden">
            <h2 class="text-3xl font-semibold text-blue-600 mb-6">ркЕрккрлВрк░рлНркгрк╛ркВркХркирлЛ рккрк░рк┐ркЪркп: рккрлАркЭрк╛ркирк╛ ркнрк╛ркЧрлЛ</h2>
            <p class="text-gray-700 mb-4">рккрлАркЭрк╛ркирлЗ ркХрлЗркЯрк▓рк╛ ркнрк╛ркЧркорк╛ркВ рк╡рк╣рлЗркВркЪрк╡рлЛ ркЫрлЗ ркдрлЗ рккрк╕ркВркж ркХрк░рлЛ:</p>
            <div class="flex justify-center space-x-4 mb-6">
                <button class="button" onclick="createPizza(2)">2 ркнрк╛ркЧ</button>
                <button class="button" onclick="createPizza(3)">3 ркнрк╛ркЧ</button>
                <button class="button" onclick="createPizza(4)">4 ркнрк╛ркЧ</button>
                <button class="button" onclick="createPizza(6)">6 ркнрк╛ркЧ</button>
                <button class="button" onclick="createPizza(8)">8 ркнрк╛ркЧ</button>
            </div>
            <div class="flex justify-center items-center relative w-64 h-64 mx-auto mb-6">
                <svg id="pizzaSvg" viewBox="0 0 100 100" class="w-full h-full"></svg>
            </div>
            <p class="text-gray-700 mb-4">ркХрлЗркЯрк▓рк╛ ркнрк╛ркЧ рккрк╕ркВркж ркХрк░рк╡рк╛ ркЫрлЗ?</p>
            <div id="numeratorButtons" class="flex justify-center space-x-2 flex-wrap gap-2 mb-6">
                <!-- Numerator buttons will be added here by JS -->
            </div>
            <div class="fraction-display" id="currentFractionDisplay"></div>
            <button class="button mt-8" onclick="showMenu()">ркорлБркЦрлНркп ркорлЗркирлБ</button>
        </div>

        <!-- 2. рк░рк╛рк╖рлНркЯрлНрк░рлАркп ркзрлНрк╡ркЬркорк╛ркВ ркЕрккрлВрк░рлНркгрк╛ркВркХ (Fractions in National Flags) -->
        <div id="flagFractions" class="hidden">
            <h2 class="text-3xl font-semibold text-blue-600 mb-6">рк░рк╛рк╖рлНркЯрлНрк░рлАркп ркзрлНрк╡ркЬркорк╛ркВ ркЕрккрлВрк░рлНркгрк╛ркВркХ</h2>
            <p class="text-gray-700 mb-4">ркнрк╛рк░ркдрлАркп ркзрлНрк╡ркЬркорк╛ркВ ркжрк░рлЗркХ рк░ркВркЧ ркХрлЗркЯрк▓рк╛ ркнрк╛ркЧркорк╛ркВ ркЫрлЗ ркдрлЗ ркУрк│ркЦрлЛ.</p>
            <div class="flex flex-col items-center justify-center w-64 h-40 mx-auto border-2 border-gray-400 rounded-lg overflow-hidden mb-6">
                <!-- Indian Flag SVG/Divs -->
                <div class="flag-stripe w-full h-1/3 bg-orange-500 flex items-center justify-center text-white font-bold text-lg">ркХрлЗрк╕рк░рлА</div>
                <div class="flag-stripe w-full h-1/3 bg-white flex items-center justify-center relative">
                    <!-- Ashoka Chakra (simplified SVG) -->
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#000080" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-circle">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="2" x2="12" y2="22"></line>
                        <line x1="22" y1="12" x2="2" y2="12"></line>
                        <line x1="18.32" y1="5.68" x2="5.68" y2="18.32"></line>
                        <line x1="5.68" y1="5.68" x2="18.32" y2="18.32"></line>
                        <line x1="12" y1="3.5" x2="12" y2="20.5"></line>
                        <line x1="3.5" y1="12" x2="20.5" y2="12"></line>
                        <line x1="17.07" y1="6.93" x2="6.93" y2="17.07"></line>
                        <line x1="6.93" y1="6.93" x2="17.07" y2="17.07"></line>
                        <line x1="12" y1="4.5" x2="12" y2="19.5"></line>
                        <line x1="4.5" y1="12" x2="19.5" y2="12"></line>
                        <line x1="16.21" y1="7.79" x2="7.79" y2="16.21"></line>
                        <line x1="7.79" y1="7.79" x2="16.21" y2="16.21"></line>
                    </svg>
                </div>
                <div class="flag-stripe w-full h-1/3 bg-green-600 flex items-center justify-center text-white font-bold text-lg">рк▓рлАрк▓рлЛ</div>
            </div>
            <p class="text-gray-700 mb-4">ркХрлЗрк╕рк░рлА рк░ркВркЧ ркзрлНрк╡ркЬркирк╛ ркХркпрк╛ ркнрк╛ркЧркорк╛ркВ ркЫрлЗ?</p>
            <div class="flex justify-center space-x-4 mb-6">
                <button class="button" onclick="checkFlagAnswer('1/3', 'ркХрлЗрк╕рк░рлА')">1/3</button>
                <button class="button" onclick="checkFlagAnswer('1/2', 'ркХрлЗрк╕рк░рлА')">1/2</button>
                <button class="button" onclick="checkFlagAnswer('1/4', 'ркХрлЗрк╕рк░рлА')">1/4</button>
            </div>
            <p class="text-gray-700 mb-4">рк▓рлАрк▓рлЛ рк░ркВркЧ ркзрлНрк╡ркЬркирк╛ ркХркпрк╛ ркнрк╛ркЧркорк╛ркВ ркЫрлЗ?</p>
            <div class="flex justify-center space-x-4 mb-6">
                <button class="button" onclick="checkFlagAnswer('1/3', 'рк▓рлАрк▓рлЛ')">1/3</button>
                <button class="button" onclick="checkFlagAnswer('1/2', 'рк▓рлАрк▓рлЛ')">1/2</button>
                <button class="button" onclick="checkFlagAnswer('1/6', 'рк▓рлАрк▓рлЛ')">1/6</button>
            </div>
            <button class="button mt-8" onclick="showMenu()">ркорлБркЦрлНркп ркорлЗркирлБ</button>
        </div>

        <!-- 3. рк╡рк░рлНркдрлБрк│ркирк╛ ркнрк╛ркЧрлЛ (Parts of a Circle) -->
        <div id="circleParts" class="hidden">
            <h2 class="text-3xl font-semibold text-blue-600 mb-6">рк╡рк░рлНркдрлБрк│ркирк╛ ркнрк╛ркЧрлЛ</h2>
            <p class="text-gray-700 mb-4">рк╡рк░рлНркдрлБрк│ркирк╛ ркХрлЗркЯрк▓рк╛ ркнрк╛ркЧ ркХрк░рк╡рк╛ ркЫрлЗ ркдрлЗ рккрк╕ркВркж ркХрк░рлЛ ркЕркирлЗ ркнрк╛ркЧрлЛ рккрк░ ркХрлНрк▓рк┐ркХ ркХрк░рлАркирлЗ ркЕрккрлВрк░рлНркгрк╛ркВркХ ркмркирк╛рк╡рлЛ.</p>
            <div class="flex justify-center space-x-4 mb-6">
                <button class="button" onclick="createCircle(2)">2 ркнрк╛ркЧ</button>
                <button class="button" onclick="createCircle(4)">4 ркнрк╛ркЧ</button>
                <button class="button" onclick="createCircle(8)">8 ркнрк╛ркЧ</button>
            </div>
            <div class="flex justify-center items-center relative w-64 h-64 mx-auto mb-6">
                <svg id="circleSvg" viewBox="0 0 100 100" class="w-full h-full"></svg>
            </div>
            <div class="fraction-display" id="currentCircleFraction"></div>
            <button class="button mt-8" onclick="showMenu()">ркорлБркЦрлНркп ркорлЗркирлБ</button>
        </div>

        <!-- 4. ркЪрлЛркХрк▓рлЗркЯ ркЕркирлЗ ркЯрлЛрккрлАркУркорк╛ркВ ркЕрккрлВрк░рлНркгрк╛ркВркХ (Fractions in Chocolates and Hats) -->
        <div id="chocolateHats" class="hidden">
            <h2 class="text-3xl font-semibold text-blue-600 mb-6">ркЪрлЛркХрк▓рлЗркЯ ркЕркирлЗ ркЯрлЛрккрлАркУркорк╛ркВ ркЕрккрлВрк░рлНркгрк╛ркВркХ</h2>
            <p class="text-gray-700 mb-4">ркЖ ркЪрлЛркХрк▓рлЗркЯркорк╛ркВ 8 ркЯрлБркХркбрк╛ ркЫрлЗ. ркЬрлЛ ркдркорлЗ 1/4 ркнрк╛ркЧ ркЦрк╛ркУ, ркдрлЛ ркХрлЗркЯрк▓рк╛ ркЯрлБркХркбрк╛ ркЦрк╛ркзрк╛?</p>
            <div class="flex justify-center items-center mb-6">
                <div class="flex flex-wrap w-64 h-24 border-2 border-brown-700 rounded-lg overflow-hidden">
                    <!-- Chocolate segments -->
                    <div class="w-1/4 h-1/2 bg-amber-800 border border-amber-900"></div>
                    <div class="w-1/4 h-1/2 bg-amber-800 border border-amber-900"></div>
                    <div class="w-1/4 h-1/2 bg-amber-800 border border-amber-900"></div>
                    <div class="w-1/4 h-1/2 bg-amber-800 border border-amber-900"></div>
                    <div class="w-1/4 h-1/2 bg-amber-800 border border-amber-900"></div>
                    <div class="w-1/4 h-1/2 bg-amber-800 border border-amber-900"></div>
                    <div class="w-1/4 h-1/2 bg-amber-800 border border-amber-900"></div>
                    <div class="w-1/4 h-1/2 bg-amber-800 border border-amber-900"></div>
                </div>
            </div>
            <div class="flex justify-center space-x-4 mb-6">
                <button class="button" onclick="checkChocolateAnswer(2)">2 ркЯрлБркХркбрк╛</button>
                <button class="button" onclick="checkChocolateAnswer(4)">4 ркЯрлБркХркбрк╛</button>
                <button class="button" onclick="checkChocolateAnswer(1)">1 ркЯрлБркХркбрлЛ</button>
            </div>

            <p class="text-gray-700 mb-4 mt-8">ркЕрк╣рлАркВ 6 ркЯрлЛрккрлАркУ ркЫрлЗ. ркЬрлЛ 1/3 ркЯрлЛрккрлАркУ рк▓рк╛рк▓ рк╣рлЛркп, ркдрлЛ ркХрлЗркЯрк▓рлА ркЯрлЛрккрлАркУ рк▓рк╛рк▓ ркЫрлЗ?</p>
            <div class="flex justify-center space-x-4 mb-6">
                <!-- Hats (simple circles) -->
                <div class="w-12 h-12 rounded-full bg-gray-400 flex items-center justify-center text-xl">ЁЯОй</div>
                <div class="w-12 h-12 rounded-full bg-gray-400 flex items-center justify-center text-xl">ЁЯОй</div>
                <div class="w-12 h-12 rounded-full bg-gray-400 flex items-center justify-center text-xl">ЁЯОй</div>
                <div class="w-12 h-12 rounded-full bg-gray-400 flex items-center justify-center text-xl">ЁЯОй</div>
                <div class="w-12 h-12 rounded-full bg-gray-400 flex items-center justify-center text-xl">ЁЯОй</div>
                <div class="w-12 h-12 rounded-full bg-gray-400 flex items-center justify-center text-xl">ЁЯОй</div>
            </div>
            <div class="flex justify-center space-x-4 mb-6">
                <button class="button" onclick="checkHatAnswer(1)">1 ркЯрлЛрккрлА</button>
                <button class="button" onclick="checkHatAnswer(2)">2 ркЯрлЛрккрлАркУ</button>
                <button class="button" onclick="checkHatAnswer(3)">3 ркЯрлЛрккрлАркУ</button>
            </div>
            <button class="button mt-8" onclick="showMenu()">ркорлБркЦрлНркп ркорлЗркирлБ</button>
        </div>

        <!-- 5. ркнрлМркорк┐ркдрк┐ркХ ркЖркХрк╛рк░рлЛркирк╛ ркнрк╛ркЧрлЛ (Equal Parts of Triangles and Rectangles) -->
        <div id="geometricShapes" class="hidden">
            <h2 class="text-3xl font-semibold text-blue-600 mb-6">ркнрлМркорк┐ркдрк┐ркХ ркЖркХрк╛рк░рлЛркирк╛ ркнрк╛ркЧрлЛ</h2>
            <p class="text-gray-700 mb-4">ркдрлНрк░рк┐ркХрлЛркгркирк╛ 3 рк╕рк░ркЦрк╛ ркнрк╛ркЧ ркХрк░рлЛ ркЕркирлЗ ркПркХ ркнрк╛ркЧркирлЗ рк░ркВркЧрлЛ.</p>
            <div class="triangle-container">
                <svg id="triangleSvg" class="triangle-svg" viewBox="0 0 100 86.6">
                    <!-- Equilateral triangle path -->
                    <polygon points="50,0 0,86.6 100,86.6" fill="#f0f9ff" stroke="#3b82f6" stroke-width="2"/>
                    <!-- Paths for 3 equal parts (example: from center to vertices) -->
                    <path d="M50,28.87 L0,86.6 L100,86.6 Z" fill="none" stroke="#a7d9f7" stroke-width="1"/>
                    <path d="M50,28.87 L50,86.6 L0,86.6 Z" fill="none" stroke="#a7d9f7" stroke-width="1"/>
                    <path d="M50,28.87 L100,86.6 L50,86.6 Z" fill="none" stroke="#a7d9f7" stroke-width="1"/>
                    <!-- Actual clickable parts will be generated by JS for better control -->
                </svg>
            </div>
            <p class="text-gray-700 mb-4">ркЙрккрк░ркирк╛ ркдрлНрк░рк┐ркХрлЛркгркирк╛ 3 рк╕рк░ркЦрк╛ ркнрк╛ркЧ ркХрк░рк╡рк╛ ркорк╛ркЯрлЗ ркдрлЗркирк╛ рккрк░ ркХрлНрк▓рк┐ркХ ркХрк░рлЛ. рккркЫрлА ркПркХ ркнрк╛ркЧ рккрк░ ркХрлНрк▓рк┐ркХ ркХрк░рлАркирлЗ ркдрлЗркирлЗ рк░ркВркЧрлЛ.</p>
            <div class="fraction-display" id="currentTriangleFraction"></div>
            <button class="button mt-8" onclick="resetTriangle()">рклрк░рлАркерлА рк╕рлЗркЯ ркХрк░рлЛ</button>

            <p class="text-gray-700 mb-4 mt-8">рк▓ркВркмркЪрлЛрк░рк╕ркирк╛ 6 рк╕рк░ркЦрк╛ ркнрк╛ркЧ ркХрк░рлЛ ркЕркирлЗ 1/6 ркнрк╛ркЧркирлЗ рк░ркВркЧрлЛ.</p>
            <div id="rectangleGrid" class="rectangle-grid">
                <!-- Grid cells will be generated by JS -->
            </div>
            <div class="fraction-display" id="currentRectangleFraction"></div>
            <button class="button mt-8" onclick="resetRectangle()">рклрк░рлАркерлА рк╕рлЗркЯ ркХрк░рлЛ</button>
            <button class="button mt-8 ml-4" onclick="showMenu()">ркорлБркЦрлНркп ркорлЗркирлБ</button>
        </div>

        <!-- 6. рк▓рлЛркнрлА ркЪрлЛркХрлАркжрк╛рк░ркирлА рк╡рк╛рк░рлНркдрк╛ (Story of the Greedy Gatekeeper) -->
        <div id="greedyGatekeeper" class="hidden">
            <h2 class="text-3xl font-semibold text-blue-600 mb-6">рк▓рлЛркнрлА ркЪрлЛркХрлАркжрк╛рк░ркирлА рк╡рк╛рк░рлНркдрк╛</h2>
            <p class="text-gray-700 mb-4">ркПркХ рк░рк╛ркЬрк╛ рк╣ркдрлЛ ркЬрлЗркгрлЗ ркПркХ ркЧрк░рлАркм ркорк╛ркгрк╕ркирлЗ ркЗркирк╛рко ркЖрккрк╡рк╛ркирлБркВ ркиркХрлНркХрлА ркХрк░рлНркпрлБркВ. рк░рк╕рлНркдрк╛ркорк╛ркВ ркдрлНрк░ркг ркЪрлЛркХрлАркжрк╛рк░рлЛ рк╣ркдрк╛.</p>
            <p class="text-gray-700 mb-4">рккрлНрк░ркерко ркЪрлЛркХрлАркжрк╛рк░рлЗ ркЗркирк╛ркоркирлЛ $\frac{1}{2}$ ркнрк╛ркЧ рк▓рлАркзрлЛ. ркЬрлЛ ркЗркирк╛ркоркорк╛ркВ 100 рк╕рлЛркирк╛ркирк╛ рк╕рк┐ркХрлНркХрк╛ рк╣рлЛркп, ркдрлЛ ркХрлЗркЯрк▓рк╛ рк╕рк┐ркХрлНркХрк╛ ркмрк╛ркХрлА рк░рк╣рлНркпрк╛?</p>
            <input type="number" id="gatekeeper1Answer" class="border-2 border-gray-300 rounded-lg p-2 mb-4 w-32 text-center" placeholder="ркЬрк╡рк╛ркм">
            <button class="button" onclick="checkGatekeeper1()">ркЪркХрк╛рк╕рлЛ</button>
            <p id="gatekeeper1Feedback" class="text-sm mt-2"></p>

            <p class="text-gray-700 mb-4 mt-6">ркмрлАркЬрк╛ ркЪрлЛркХрлАркжрк╛рк░рлЗ ркмрк╛ркХрлА рк░рк╣рлЗрк▓рк╛ рк╕рк┐ркХрлНркХрк╛ркирлЛ $\frac{1}{2}$ ркнрк╛ркЧ рк▓рлАркзрлЛ. рк╣рк╡рлЗ ркХрлЗркЯрк▓рк╛ рк╕рк┐ркХрлНркХрк╛ ркмрк╛ркХрлА рк░рк╣рлНркпрк╛?</p>
            <input type="number" id="gatekeeper2Answer" class="border-2 border-gray-300 rounded-lg p-2 mb-4 w-32 text-center" placeholder="ркЬрк╡рк╛ркм">
            <button class="button" onclick="checkGatekeeper2()">ркЪркХрк╛рк╕рлЛ</button>
            <p id="gatekeeper2Feedback" class="text-sm mt-2"></p>

            <p class="text-gray-700 mb-4 mt-6">ркдрлНрк░рлАркЬрк╛ ркЪрлЛркХрлАркжрк╛рк░рлЗ ркмрк╛ркХрлА рк░рк╣рлЗрк▓рк╛ рк╕рк┐ркХрлНркХрк╛ркирлЛ $\frac{1}{2}$ ркнрк╛ркЧ рк▓рлАркзрлЛ. рк╣рк╡рлЗ ркЧрк░рлАркм ркорк╛ркгрк╕ рккрк╛рк╕рлЗ ркХрлЗркЯрк▓рк╛ рк╕рк┐ркХрлНркХрк╛ рк░рк╣рлНркпрк╛?</p>
            <input type="number" id="gatekeeper3Answer" class="border-2 border-gray-300 rounded-lg p-2 mb-4 w-32 text-center" placeholder="ркЬрк╡рк╛ркм">
            <button class="button" onclick="checkGatekeeper3()">ркЪркХрк╛рк╕рлЛ</button>
            <p id="gatekeeper3Feedback" class="text-sm mt-2"></p>

            <button class="button mt-8" onclick="showMenu()">ркорлБркЦрлНркп ркорлЗркирлБ</button>
        </div>

        <!-- 7. рккрлЗркЯрк░рлНрки ркЕркирлЗ ркЕрккрлВрк░рлНркгрк╛ркВркХ (Patterns and Fractions) -->
        <div id="patternsFractions" class="hidden">
            <h2 class="text-3xl font-semibold text-blue-600 mb-6">рккрлЗркЯрк░рлНрки ркЕркирлЗ ркЕрккрлВрк░рлНркгрк╛ркВркХ</h2>
            <p class="text-gray-700 mb-4">16 ркЪрлЛрк░рк╕ркирлА ркЧрлНрк░рлАркбркорк╛ркВ 1/4 ркнрк╛ркЧркирлЗ рк▓рк╛рк▓ рк░ркВркЧ ркХрк░рлЛ ркЕркирлЗ ркПркХ рк╕рлБркВркжрк░ рккрлЗркЯрк░рлНрки ркмркирк╛рк╡рлЛ. рккркЫрлА рк╕рклрлЗркж ркнрк╛ркЧркирлЛ ркЕрккрлВрк░рлНркгрк╛ркВркХ рк╢рлЛркзрлЛ.</p>
            <div id="patternGrid" class="grid grid-cols-4 grid-rows-4 w-64 h-64 mx-auto border-2 border-gray-400 rounded-lg overflow-hidden">
                <!-- Grid cells will be generated by JS -->
            </div>
            <p class="text-gray-700 mt-4">рк▓рк╛рк▓ рк░ркВркЧрлАрки ркЪрлЛрк░рк╕: <span id="coloredSquaresCount" class="font-bold">0</span></p>
            <p class="text-gray-700">рк╕рклрлЗркж ркЪрлЛрк░рк╕: <span id="whiteSquaresCount" class="font-bold">16</span></p>
            <p class="text-gray-700">рк▓рк╛рк▓ ркнрк╛ркЧ: <span id="redFractionDisplay" class="font-bold">0/16</span></p>
            <p class="text-gray-700">рк╕рклрлЗркж ркнрк╛ркЧ: <span id="whiteFractionDisplay" class="font-bold">16/16</span></p>
            <button class="button mt-8" onclick="resetPatternGrid()">рклрк░рлАркерлА рк╕рлЗркЯ ркХрк░рлЛ</button>
            <button class="button mt-8 ml-4" onclick="showMenu()">ркорлБркЦрлНркп ркорлЗркирлБ</button>
        </div>

        <!-- 8. рк╢рк╛ркХркнрк╛ркЬрлАркирлБркВ ркЦрлЗркдрк░ (Vegetable Farm) -->
        <div id="vegetableFarm" class="hidden">
            <h2 class="text-3xl font-semibold text-blue-600 mb-6">рк╢рк╛ркХркнрк╛ркЬрлАркирлБркВ ркЦрлЗркдрк░</h2>
            <p class="text-gray-700 mb-4">рк░рк╛ркорлБркирк╛ ркЦрлЗркдрк░ркорк╛ркВ ркХркИ рк╢рк╛ркХркнрк╛ркЬрлА ркХрлЗркЯрк▓рк╛ ркнрк╛ркЧркорк╛ркВ ркЙркЧрк╛ркбрк╡рк╛ркорк╛ркВ ркЖрк╡рлА ркЫрлЗ ркдрлЗ рк╢рлЛркзрлЛ.</p>
            <div id="farmGrid" class="farm-grid">
                <!-- Farm cells will be generated by JS -->
            </div>
            <div class="mt-6 text-left">
                <p class="text-gray-700">ркЯрк╛ркорлЗркЯрк╛ркВркирлЛ ркнрк╛ркЧ: <span id="tomatoFraction" class="font-bold"></span></p>
                <p class="text-gray-700">ркмркЯрк╛ркХрк╛ркирлЛ ркнрк╛ркЧ: <span id="potatoFraction" class="font-bold"></span></p>
                <p class="text-gray-700">ркбрлБркВркЧрк│рлАркирлЛ ркнрк╛ркЧ: <span id="onionFraction" class="font-bold"></span></p>
                <p class="text-gray-700">ркЧрк╛ркЬрк░ркирлЛ ркнрк╛ркЧ: <span id="carrotFraction" class="font-bold"></span></p>
            </div>
            <button class="button mt-8" onclick="showMenu()">ркорлБркЦрлНркп ркорлЗркирлБ</button>
        </div>

        <!-- Message Box for alerts -->
        <div id="messageBox" class="message-box hidden">
            <h3 id="messageBoxTitle"></h3>
            <p id="messageBoxContent"></p>
            <button onclick="hideMessageBox()">ркУркХрлЗ</button>
        </div>

    </div>

    <script>
        // Global variables for game state
        let currentActivity = '';
        let pizzaDenominator = 0;
        let pizzaSelectedSlices = 0;
        let circleDenominator = 0;
        let circleSelectedSegments = 0;
        let triangleColoredParts = 0;
        let patternColoredCount = 0;
        const totalPatternSquares = 16;

        // Function to show custom message box
        function showCustomMessage(title, message) {
            document.getElementById('messageBoxTitle').innerText = title;
            document.getElementById('messageBoxContent').innerText = message;
            document.getElementById('messageBox').classList.remove('hidden');
        }

        // Function to hide custom message box
        function hideMessageBox() {
            document.getElementById('messageBox').classList.add('hidden');
        }

        // Function to show a specific activity and hide others
        function showActivity(activityId) {
            // Hide all activity containers
            document.querySelectorAll('#gameContainer > div').forEach(div => {
                if (div.id !== 'mainMenu' && div.id !== 'messageBox') {
                    div.classList.add('hidden');
                }
            });
            // Show the selected activity
            document.getElementById(activityId).classList.remove('hidden');
            document.getElementById('mainMenu').classList.add('hidden');
            currentActivity = activityId;

            // Initialize specific activities if needed
            if (activityId === 'introFractions') {
                createPizza(2); // Default to 2 parts
            } else if (activityId === 'circleParts') {
                createCircle(2); // Default to 2 parts
            } else if (activityId === 'geometricShapes') {
                renderTriangle();
                renderRectangleGrid();
            } else if (activityId === 'patternsFractions') {
                renderPatternGrid();
            } else if (activityId === 'vegetableFarm') {
                renderVegetableFarm();
            }
        }

        // Function to show the main menu
        function showMenu() {
            document.querySelectorAll('#gameContainer > div').forEach(div => {
                if (div.id !== 'mainMenu' && div.id !== 'messageBox') {
                    div.classList.add('hidden');
                }
            });
            document.getElementById('mainMenu').classList.remove('hidden');
            currentActivity = '';
        }

        // --- 1. ркЕрккрлВрк░рлНркгрк╛ркВркХркирлЛ рккрк░рк┐ркЪркп (Introduction to Fractions) ---
        function createPizza(parts) {
            pizzaDenominator = parts;
            pizzaSelectedSlices = 0;
            const pizzaSvg = document.getElementById('pizzaSvg');
            pizzaSvg.innerHTML = ''; // Clear previous pizza

            const radius = 50;
            const centerX = 50;
            const centerY = 50;

            for (let i = 0; i < parts; i++) {
                const startAngle = (360 / parts) * i;
                const endAngle = (360 / parts) * (i + 1);

                const startRad = (startAngle - 90) * Math.PI / 180;
                const endRad = (endAngle - 90) * Math.PI / 180;

                const x1 = centerX + radius * Math.cos(startRad);
                const y1 = centerY + radius * Math.sin(startRad);
                const x2 = centerX + radius * Math.cos(endRad);
                const y2 = centerY + radius * Math.sin(endRad);

                const largeArcFlag = endAngle - startAngle <= 180 ? 0 : 1;

                const pathData = [
                    `M ${centerX},${centerY}`,
                    `L ${x1},${y1}`,
                    `A ${radius},${radius} 0 ${largeArcFlag} 1 ${x2},${y2}`,
                    `Z`
                ].join(' ');

                const slice = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                slice.setAttribute('d', pathData);
                slice.classList.add('pizza-slice');
                slice.dataset.index = i; // Store index for selection
                slice.onclick = () => togglePizzaSlice(slice);
                pizzaSvg.appendChild(slice);
            }
            updateNumeratorButtons();
            updatePizzaFractionDisplay();
        }

        function togglePizzaSlice(slice) {
            slice.classList.toggle('selected');
            pizzaSelectedSlices = document.querySelectorAll('#pizzaSvg .pizza-slice.selected').length;
            updatePizzaFractionDisplay();
        }

        function updateNumeratorButtons() {
            const numButtonsDiv = document.getElementById('numeratorButtons');
            numButtonsDiv.innerHTML = '';
            for (let i = 0; i <= pizzaDenominator; i++) {
                const button = document.createElement('button');
                button.classList.add('button', 'px-4', 'py-2', 'text-sm');
                button.innerText = `${i} ркнрк╛ркЧ`;
                button.onclick = () => selectPizzaNumerator(i);
                numButtonsDiv.appendChild(button);
            }
        }

        function selectPizzaNumerator(numerator) {
            pizzaSelectedSlices = numerator;
            const slices = document.querySelectorAll('#pizzaSvg .pizza-slice');
            slices.forEach((slice, index) => {
                if (index < numerator) {
                    slice.classList.add('selected');
                } else {
                    slice.classList.remove('selected');
                }
            });
            updatePizzaFractionDisplay();
        }

        function updatePizzaFractionDisplay() {
            const display = document.getElementById('currentFractionDisplay');
            if (pizzaDenominator > 0) {
                display.innerText = `рккрк╕ркВркж ркХрк░рлЗрк▓рлЛ ркнрк╛ркЧ: ${pizzaSelectedSlices}/${pizzaDenominator}`;
            } else {
                display.innerText = '';
            }
        }

        // --- 2. рк░рк╛рк╖рлНркЯрлНрк░рлАркп ркзрлНрк╡ркЬркорк╛ркВ ркЕрккрлВрк░рлНркгрк╛ркВркХ (Fractions in National Flags) ---
        function checkFlagAnswer(selectedFraction, color) {
            let correctFraction = '';
            if (color === 'ркХрлЗрк╕рк░рлА') {
                correctFraction = '1/3';
            } else if (color === 'рк▓рлАрк▓рлЛ') {
                correctFraction = '1/3';
            }

            if (selectedFraction === correctFraction) {
                showCustomMessage('рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм!', `рк╕рк░рк╕! ркнрк╛рк░ркдрлАркп ркзрлНрк╡ркЬркорк╛ркВ ${color} рк░ркВркЧ ${correctFraction} ркнрк╛ркЧркорк╛ркВ ркЫрлЗ.`);
            } else {
                showCustomMessage('ркЦрлЛркЯрлЛ ркЬрк╡рк╛ркм', `рклрк░рлА рккрлНрк░ркпрк╛рк╕ ркХрк░рлЛ. ${color} рк░ркВркЧркирлЛ рк╕рк╛ркЪрлЛ ркнрк╛ркЧ ${correctFraction} ркЫрлЗ.`);
            }
        }

        // --- 3. рк╡рк░рлНркдрлБрк│ркирк╛ ркнрк╛ркЧрлЛ (Parts of a Circle) ---
        function createCircle(parts) {
            circleDenominator = parts;
            circleSelectedSegments = 0;
            const circleSvg = document.getElementById('circleSvg');
            circleSvg.innerHTML = ''; // Clear previous circle

            const radius = 50;
            const centerX = 50;
            const centerY = 50;

            for (let i = 0; i < parts; i++) {
                const startAngle = (360 / parts) * i;
                const endAngle = (360 / parts) * (i + 1);

                const startRad = (startAngle - 90) * Math.PI / 180;
                const endRad = (endAngle - 90) * Math.PI / 180;

                const x1 = centerX + radius * Math.cos(startRad);
                const y1 = centerY + radius * Math.sin(startRad);
                const x2 = centerX + radius * Math.cos(endRad);
                const y2 = centerY + radius * Math.sin(endRad);

                const largeArcFlag = endAngle - startAngle <= 180 ? 0 : 1;

                const pathData = [
                    `M ${centerX},${centerY}`,
                    `L ${x1},${y1}`,
                    `A ${radius},${radius} 0 ${largeArcFlag} 1 ${x2},${y2}`,
                    `Z`
                ].join(' ');

                const segment = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                segment.setAttribute('d', pathData);
                segment.classList.add('pizza-slice'); // Reusing pizza-slice class for styling
                segment.dataset.index = i;
                segment.onclick = () => toggleCircleSegment(segment);
                circleSvg.appendChild(segment);
            }
            updateCircleFractionDisplay();
        }

        function toggleCircleSegment(segment) {
            segment.classList.toggle('selected');
            circleSelectedSegments = document.querySelectorAll('#circleSvg .pizza-slice.selected').length;
            updateCircleFractionDisplay();
        }

        function updateCircleFractionDisplay() {
            const display = document.getElementById('currentCircleFraction');
            if (circleDenominator > 0) {
                display.innerText = `рккрк╕ркВркж ркХрк░рлЗрк▓рлЛ ркнрк╛ркЧ: ${circleSelectedSegments}/${circleDenominator}`;
            } else {
                display.innerText = '';
            }
        }

        // --- 4. ркЪрлЛркХрк▓рлЗркЯ ркЕркирлЗ ркЯрлЛрккрлАркУркорк╛ркВ ркЕрккрлВрк░рлНркгрк╛ркВркХ (Fractions in Chocolates and Hats) ---
        function checkChocolateAnswer(answer) {
            // Chocolate has 8 pieces. 1/4 of 8 is (1/4) * 8 = 2.
            if (answer === 2) {
                showCustomMessage('рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм!', 'ркЦрлВркм рк╕рк░рк╕! ркдркорлЗ 2 ркЯрлБркХркбрк╛ ркЦрк╛ркзрк╛.');
            } else {
                showCustomMessage('ркЦрлЛркЯрлЛ ркЬрк╡рк╛ркм', 'рклрк░рлА рккрлНрк░ркпрк╛рк╕ ркХрк░рлЛ. 1/4 ркнрк╛ркЧ ркПркЯрк▓рлЗ 2 ркЯрлБркХркбрк╛.');
            }
        }

        function checkHatAnswer(answer) {
            // There are 6 hats. 1/3 of 6 is (1/3) * 6 = 2.
            if (answer === 2) {
                showCustomMessage('рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм!', 'ркмрк░рк╛ркмрк░! 2 ркЯрлЛрккрлАркУ рк▓рк╛рк▓ ркЫрлЗ.');
            } else {
                showCustomMessage('ркЦрлЛркЯрлЛ ркЬрк╡рк╛ркм', 'рклрк░рлА рккрлНрк░ркпрк╛рк╕ ркХрк░рлЛ. 1/3 ркнрк╛ркЧ ркПркЯрк▓рлЗ 2 ркЯрлЛрккрлАркУ.');
            }
        }

        // --- 5. ркнрлМркорк┐ркдрк┐ркХ ркЖркХрк╛рк░рлЛркирк╛ ркнрк╛ркЧрлЛ (Equal Parts of Triangles and Rectangles) ---
        function renderTriangle() {
            const triangleSvg = document.getElementById('triangleSvg');
            triangleSvg.innerHTML = ''; // Clear previous content

            // Base triangle (equilateral for simplicity, 100x86.6)
            const baseTrianglePath = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            baseTrianglePath.setAttribute('points', '50,0 0,86.6 100,86.6');
            baseTrianglePath.setAttribute('fill', '#f0f9ff');
            baseTrianglePath.setAttribute('stroke', '#3b82f6');
            baseTrianglePath.setAttribute('stroke-width', '2');
            triangleSvg.appendChild(baseTrianglePath);

            // Create 3 equal parts by drawing lines from centroid to midpoints of sides
            // Centroid of (x1,y1), (x2,y2), (x3,y3) is ((x1+x2+x3)/3, (y1+y2+y3)/3)
            // Vertices: A(50,0), B(0,86.6), C(100,86.6)
            const centroidX = (50 + 0 + 100) / 3; // 50
            const centroidY = (0 + 86.6 + 86.6) / 3; // 57.73

            // Midpoints of sides
            const midABX = (50 + 0) / 2; // 25
            const midABY = (0 + 86.6) / 2; // 43.3
            const midBCX = (0 + 100) / 2; // 50
            const midBCY = (86.6 + 86.6) / 2; // 86.6
            const midCAX = (100 + 50) / 2; // 75
            const midCAY = (86.6 + 0) / 2; // 43.3

            // Define paths for 3 smaller triangles (from centroid to two vertices)
            const partsData = [
                // Part 1 (top)
                `M${centroidX},${centroidY} L50,0 L0,86.6 Z`, // This is not correct for 3 equal parts from centroid
                // Correct way for 3 equal parts: connect centroid to vertices
                // Part 1: Centroid, A, B
                `M${centroidX},${centroidY} L50,0 L0,86.6 Z`,
                // Part 2: Centroid, B, C
                `M${centroidX},${centroidY} L0,86.6 L100,86.6 Z`,
                // Part 3: Centroid, C, A
                `M${centroidX},${centroidY} L100,86.6 L50,0 Z`
            ];

            // For 3 equal parts of a triangle, it's usually done by connecting the centroid to the midpoints of the sides, or simply by dividing into 3 smaller triangles from a common vertex.
            // Let's simplify and make 3 vertical strips for a rectangle-like division for visual clarity for kids, or use a common vertex.
            // A simpler way for a triangle to be divided into 3 equal parts for kids is often by dividing it into 3 smaller triangles from one vertex to two points on the opposite side.
            // Or, by connecting the centroid to each vertex, which creates 3 triangles of equal area.

            // Let's use the centroid method, but make sure the paths are distinct and clickable.
            // Path 1: Centroid to (50,0) (top vertex) to (0,86.6) (bottom left)
            const path1 = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            path1.setAttribute('points', `${centroidX},${centroidY} 50,0 0,86.6`);
            path1.classList.add('triangle-part');
            path1.onclick = () => toggleTrianglePart(path1);
            triangleSvg.appendChild(path1);

            // Path 2: Centroid to (0,86.6) (bottom left) to (100,86.6) (bottom right)
            const path2 = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            path2.setAttribute('points', `${centroidX},${centroidY} 0,86.6 100,86.6`);
            path2.classList.add('triangle-part');
            path2.onclick = () => toggleTrianglePart(path2);
            triangleSvg.appendChild(path2);

            // Path 3: Centroid to (100,86.6) (bottom right) to (50,0) (top vertex)
            const path3 = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            path3.setAttribute('points', `${centroidX},${centroidY} 100,86.6 50,0`);
            path3.classList.add('triangle-part');
            path3.onclick = () => toggleTrianglePart(path3);
            triangleSvg.appendChild(path3);

            // Add lines from centroid to vertices to make divisions visible
            const line1 = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line1.setAttribute('x1', centroidX); line1.setAttribute('y1', centroidY);
            line1.setAttribute('x2', 50); line1.setAttribute('y2', 0);
            line1.setAttribute('stroke', '#a7d9f7'); line1.setAttribute('stroke-width', '1');
            triangleSvg.appendChild(line1);

            const line2 = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line2.setAttribute('x1', centroidX); line2.setAttribute('y1', centroidY);
            line2.setAttribute('x2', 0); line2.setAttribute('y2', 86.6);
            line2.setAttribute('stroke', '#a7d9f7'); line2.setAttribute('stroke-width', '1');
            triangleSvg.appendChild(line2);

            const line3 = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line3.setAttribute('x1', centroidX); line3.setAttribute('y1', centroidY);
            line3.setAttribute('x2', 100); line3.setAttribute('y2', 86.6);
            line3.setAttribute('stroke', '#a7d9f7'); line3.setAttribute('stroke-width', '1');
            triangleSvg.appendChild(line3);

            triangleColoredParts = 0;
            updateTriangleFractionDisplay();
        }

        function toggleTrianglePart(part) {
            part.classList.toggle('colored');
            triangleColoredParts = document.querySelectorAll('#triangleSvg .triangle-part.colored').length;
            updateTriangleFractionDisplay();
        }

        function updateTriangleFractionDisplay() {
            const display = document.getElementById('currentTriangleFraction');
            display.innerText = `рк░ркВркЧрлАрки ркнрк╛ркЧ: ${triangleColoredParts}/3`;
        }

        function resetTriangle() {
            renderTriangle();
        }

        function renderRectangleGrid() {
            const grid = document.getElementById('rectangleGrid');
            grid.innerHTML = ''; // Clear previous content
            grid.style.gridTemplateColumns = 'repeat(3, 1fr)';
            grid.style.gridTemplateRows = 'repeat(2, 1fr)';

            for (let i = 0; i < 6; i++) {
                const cell = document.createElement('div');
                cell.classList.add('grid-cell');
                cell.dataset.index = i;
                cell.onclick = () => toggleRectangleCell(cell);
                grid.appendChild(cell);
            }
            updateRectangleFractionDisplay();
        }

        let rectangleColoredCells = 0;
        function toggleRectangleCell(cell) {
            cell.classList.toggle('colored');
            rectangleColoredCells = document.querySelectorAll('#rectangleGrid .grid-cell.colored').length;
            updateRectangleFractionDisplay();
        }

        function updateRectangleFractionDisplay() {
            const display = document.getElementById('currentRectangleFraction');
            display.innerText = `рк░ркВркЧрлАрки ркнрк╛ркЧ: ${rectangleColoredCells}/6`;
        }

        function resetRectangle() {
            renderRectangleGrid();
            rectangleColoredCells = 0;
        }

        // --- 6. рк▓рлЛркнрлА ркЪрлЛркХрлАркжрк╛рк░ркирлА рк╡рк╛рк░рлНркдрк╛ (Story of the Greedy Gatekeeper) ---
        let totalCoins = 100;
        let remainingCoins = 100;

        function checkGatekeeper1() {
            const answerInput = document.getElementById('gatekeeper1Answer');
            const feedbackDiv = document.getElementById('gatekeeper1Feedback');
            const taken = totalCoins / 2; // 1/2 of 100 = 50
            const expectedRemaining = totalCoins - taken; // 100 - 50 = 50

            if (parseInt(answerInput.value) === expectedRemaining) {
                feedbackDiv.innerText = 'рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм! рк╣рк╡рлЗ 50 рк╕рк┐ркХрлНркХрк╛ ркмрк╛ркХрлА рк░рк╣рлНркпрк╛.';
                feedbackDiv.classList.remove('text-red-500');
                feedbackDiv.classList.add('text-green-600');
                remainingCoins = expectedRemaining;
            } else {
                feedbackDiv.innerText = `ркЦрлЛркЯрлЛ ркЬрк╡рк╛ркм. рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм ${expectedRemaining} ркЫрлЗ.`;
                feedbackDiv.classList.remove('text-green-600');
                feedbackDiv.classList.add('text-red-500');
            }
        }

        function checkGatekeeper2() {
            const answerInput = document.getElementById('gatekeeper2Answer');
            const feedbackDiv = document.getElementById('gatekeeper2Feedback');
            const taken = remainingCoins / 2; // 1/2 of 50 = 25
            const expectedRemaining = remainingCoins - taken; // 50 - 25 = 25

            if (parseInt(answerInput.value) === expectedRemaining) {
                feedbackDiv.innerText = 'рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм! рк╣рк╡рлЗ 25 рк╕рк┐ркХрлНркХрк╛ ркмрк╛ркХрлА рк░рк╣рлНркпрк╛.';
                feedbackDiv.classList.remove('text-red-500');
                feedbackDiv.classList.add('text-green-600');
                remainingCoins = expectedRemaining;
            } else {
                feedbackDiv.innerText = `ркЦрлЛркЯрлЛ ркЬрк╡рк╛ркм. рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм ${expectedRemaining} ркЫрлЗ.`;
                feedbackDiv.classList.remove('text-green-600');
                feedbackDiv.classList.add('text-red-500');
            }
        }

        function checkGatekeeper3() {
            const answerInput = document.getElementById('gatekeeper3Answer');
            const feedbackDiv = document.getElementById('gatekeeper3Feedback');
            const taken = remainingCoins / 2; // 1/2 of 25 = 12.5 (round down for coins)
            const expectedRemaining = remainingCoins - taken; // 25 - 12.5 = 12.5 (let's assume coins can be half for this problem or round to 12)
            // For simplicity, let's assume it's a whole number problem, so maybe the initial coins were 80 or 64.
            // Given 100, it's better to stick to the exact fraction.
            // If the problem implies whole coins, then it's a trick question or needs clarification.
            // For educational purposes, let's assume the question implies the *value* of coins.
            // 100 -> 50 -> 25 -> 12.5
            // Let's adjust the problem slightly for whole numbers if needed, or explain.
            // For 5th grade, it's likely they expect whole numbers.
            // Let's make the initial coins 64 for perfect halves: 64 -> 32 -> 16 -> 8
            // Or, keep 100 and indicate it's about the *value* or that coins can be split.
            // Sticking to the problem as is, 12.5.
            // If user enters 12 or 13, it's close. Let's make it strict for now.

            // Re-evaluating for 5th grade context: fractions often result in whole numbers for quantities.
            // Let's re-frame the problem slightly or assume a different starting number.
            // If the PDF implies whole numbers, the initial number must be a multiple of 8 (2*2*2).
            // Let's use 80 coins for a cleaner example: 80 -> 40 -> 20 -> 10
            // Or, 40 coins: 40 -> 20 -> 10 -> 5.
            // Let's change the initial coins to 40 for this example.

            // Resetting for a better example that yields whole numbers for 5th grade.
            // Let's assume the problem means 'half of the *remaining* coins'.
            // If 100 coins:
            // 1st: 1/2 of 100 = 50. Remaining: 50.
            // 2nd: 1/2 of 50 = 25. Remaining: 25.
            // 3rd: 1/2 of 25 = 12.5. Remaining: 12.5.
            // This is problematic for "coins".

            // Let's assume the story is simplified for the concept, and the answer is 12.5.
            // Or, let's use a total that works out evenly, like 80 coins.
            // For the sake of the game, let's assume the user will enter 12.5.
            // Or, better, simplify the problem to avoid decimals for 5th grade.
            // Let's modify the problem in the UI to say "80 рк╕рлЛркирк╛ркирк╛ рк╕рк┐ркХрлНркХрк╛".

            // Update: The problem in the PDF might be abstract. Let's stick to 100 and allow 12.5.
            // Or, let's make it a multiple choice.
            // For input type="number", 12.5 is a valid input.

            if (parseFloat(answerInput.value) === expectedRemaining) {
                feedbackDiv.innerText = 'рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм! ркЧрк░рлАркм ркорк╛ркгрк╕ рккрк╛рк╕рлЗ 12.5 рк╕рк┐ркХрлНркХрк╛ рк░рк╣рлНркпрк╛.';
                feedbackDiv.classList.remove('text-red-500');
                feedbackDiv.classList.add('text-green-600');
            } else {
                feedbackDiv.innerText = `ркЦрлЛркЯрлЛ ркЬрк╡рк╛ркм. рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм ${expectedRemaining} ркЫрлЗ.`;
                feedbackDiv.classList.remove('text-green-600');
                feedbackDiv.classList.add('text-red-500');
            }
        }

        // --- 7. рккрлЗркЯрк░рлНрки ркЕркирлЗ ркЕрккрлВрк░рлНркгрк╛ркВркХ (Patterns and Fractions) ---
        function renderPatternGrid() {
            const grid = document.getElementById('patternGrid');
            grid.innerHTML = '';
            patternColoredCount = 0;

            for (let i = 0; i < totalPatternSquares; i++) {
                const cell = document.createElement('div');
                cell.classList.add('grid-cell', 'w-full', 'h-full', 'bg-white', 'border', 'border-gray-300');
                cell.dataset.index = i;
                cell.onclick = () => togglePatternCell(cell);
                grid.appendChild(cell);
            }
            updatePatternFractionDisplay();
        }

        function togglePatternCell(cell) {
            cell.classList.toggle('bg-red-400'); // Use Tailwind class for red
            cell.classList.toggle('bg-white'); // Toggle back to white

            patternColoredCount = document.querySelectorAll('#patternGrid .bg-red-400').length;
            updatePatternFractionDisplay();
        }

        function updatePatternFractionDisplay() {
            const redFraction = simplifyFraction(patternColoredCount, totalPatternSquares);
            const whiteCount = totalPatternSquares - patternColoredCount;
            const whiteFraction = simplifyFraction(whiteCount, totalPatternSquares);

            document.getElementById('coloredSquaresCount').innerText = patternColoredCount;
            document.getElementById('whiteSquaresCount').innerText = whiteCount;
            document.getElementById('redFractionDisplay').innerText = `${redFraction.numerator}/${redFraction.denominator}`;
            document.getElementById('whiteFractionDisplay').innerText = `${whiteFraction.numerator}/${whiteFraction.denominator}`;

            // Check if 1/4 is colored (4 out of 16)
            if (patternColoredCount === (totalPatternSquares / 4)) {
                showCustomMessage('рк╕рк░рк╕!', 'ркдркорлЗ 1/4 ркнрк╛ркЧркирлЗ рк▓рк╛рк▓ рк░ркВркЧ ркХрк░рлНркпрлЛ ркЫрлЗ!');
            }
        }

        function gcd(a, b) {
            return b === 0 ? a : gcd(b, a % b);
        }

        function simplifyFraction(numerator, denominator) {
            const common = gcd(numerator, denominator);
            return { numerator: numerator / common, denominator: denominator / common };
        }

        function resetPatternGrid() {
            renderPatternGrid();
        }

        // --- 8. рк╢рк╛ркХркнрк╛ркЬрлАркирлБркВ ркЦрлЗркдрк░ (Vegetable Farm) ---
        function renderVegetableFarm() {
            const farmGrid = document.getElementById('farmGrid');
            farmGrid.innerHTML = '';

            // Define farm layout (4x4 grid, 16 cells total)
            // Assign vegetables to cells to represent fractions
            const farmLayout = [
                'tomato', 'tomato', 'potato', 'potato',
                'tomato', 'tomato', 'potato', 'potato',
                'onion', 'onion', 'carrot', 'carrot',
                'onion', 'onion', 'carrot', 'carrot'
            ];

            const vegetableCounts = {
                tomato: 0,
                potato: 0,
                onion: 0,
                carrot: 0
            };

            farmLayout.forEach((veg, index) => {
                const cell = document.createElement('div');
                cell.classList.add('farm-cell');
                cell.dataset.veg = veg;

                const img = document.createElement('img');
                // Using placeholder images for vegetables
                if (veg === 'tomato') img.src = 'https://placehold.co/40x40/FF6347/FFFFFF?text=ЁЯНЕ';
                else if (veg === 'potato') img.src = 'https://placehold.co/40x40/A0522D/FFFFFF?text=ЁЯеФ';
                else if (veg === 'onion') img.src = 'https://placehold.co/40x40/E0BBE4/FFFFFF?text=ЁЯзЕ';
                else if (veg === 'carrot') img.src = 'https://placehold.co/40x40/FFA500/FFFFFF?text=ЁЯеХ';
                img.alt = veg;

                const text = document.createElement('span');
                text.innerText = veg === 'tomato' ? 'ркЯрк╛ркорлЗркЯрк╛ркВ' :
                                 veg === 'potato' ? 'ркмркЯрк╛ркХрк╛' :
                                 veg === 'onion' ? 'ркбрлБркВркЧрк│рлА' :
                                 'ркЧрк╛ркЬрк░';

                cell.appendChild(img);
                cell.appendChild(text);
                farmGrid.appendChild(cell);

                vegetableCounts[veg]++;
            });

            // Calculate and display fractions
            const totalCells = farmLayout.length; // 16
            document.getElementById('tomatoFraction').innerText = `${simplifyFraction(vegetableCounts.tomato, totalCells).numerator}/${simplifyFraction(vegetableCounts.tomato, totalCells).denominator}`;
            document.getElementById('potatoFraction').innerText = `${simplifyFraction(vegetableCounts.potato, totalCells).numerator}/${simplifyFraction(vegetableCounts.potato, totalCells).denominator}`;
            document.getElementById('onionFraction').innerText = `${simplifyFraction(vegetableCounts.onion, totalCells).numerator}/${simplifyFraction(vegetableCounts.onion, totalCells).denominator}`;
            document.getElementById('carrotFraction').innerText = `${simplifyFraction(vegetableCounts.carrot, totalCells).numerator}/${simplifyFraction(vegetableCounts.carrot, totalCells).denominator}`;
        }


        // Initial setup: show main menu
        document.addEventListener('DOMContentLoaded', () => {
            showMenu();
        });

    </script>
</body>
</html>
